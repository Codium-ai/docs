
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../codiumate/">
      
      
      <link rel="icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.12">
    
    
      
        <title>PR-Agent - CodiumAI</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="PR-Agent - CodiumAI" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="./assets/images/social/pragent/index.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="None" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="PR-Agent - CodiumAI" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="./assets/images/social/pragent/index.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pr-agent" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CodiumAI" class="md-header__button md-logo" aria-label="CodiumAI" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CodiumAI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PR-Agent
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Welcome to CodiumAI

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  PR-Agent

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../codiumate/" class="md-tabs__link">
        
  
    
  
  Codiumate

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../alphacodium/" class="md-tabs__link">
        
  
    
  
  AlphaCodium

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../changelog/" class="md-tabs__link">
        
  
    
  
  Changelog

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CodiumAI" class="md-nav__button md-logo" aria-label="CodiumAI" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    CodiumAI
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to CodiumAI
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    PR-Agent
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    PR-Agent
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#try-it-in-a-public-repository" class="md-nav__link">
    <span class="md-ellipsis">
      Try it in a public repository
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#available-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Available commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Available commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ask" class="md-nav__link">
    <span class="md-ellipsis">
      Ask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changelog" class="md-nav__link">
    <span class="md-ellipsis">
      Changelog
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#describe" class="md-nav__link">
    <span class="md-ellipsis">
      Describe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#improve" class="md-nav__link">
    <span class="md-ellipsis">
      Improve
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#review" class="md-nav__link">
    <span class="md-ellipsis">
      Review
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#benefits-of-pr-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Benefits of PR-Agent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pr-agent-pro" class="md-nav__link">
    <span class="md-ellipsis">
      PR-Agent Pro üíé
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      How it works
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#features-support" class="md-nav__link">
    <span class="md-ellipsis">
      Features support
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-installation-process" class="md-nav__link">
    <span class="md-ellipsis">
      Custom installation process
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Custom installation process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-docker-image" class="md-nav__link">
    <span class="md-ellipsis">
      Use Docker image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-from-source" class="md-nav__link">
    <span class="md-ellipsis">
      Run from source
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-as-a-github-action" class="md-nav__link">
    <span class="md-ellipsis">
      Run as a GitHub Action
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-as-a-polling-server" class="md-nav__link">
    <span class="md-ellipsis">
      Run as a polling server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-as-a-github-app" class="md-nav__link">
    <span class="md-ellipsis">
      Run as a GitHub App
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-as-lambda-function" class="md-nav__link">
    <span class="md-ellipsis">
      Deploy as Lambda Function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aws-codecommit-setup" class="md-nav__link">
    <span class="md-ellipsis">
      AWS CodeCommit Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AWS CodeCommit Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iam-role-example" class="md-nav__link">
    <span class="md-ellipsis">
      IAM Role Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-key-and-secret" class="md-nav__link">
    <span class="md-ellipsis">
      Access Key and Secret
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cli-example" class="md-nav__link">
    <span class="md-ellipsis">
      CLI Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-a-gitlab-webhook" class="md-nav__link">
    <span class="md-ellipsis">
      Run a GitLab webhook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-as-a-bitbucket-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Run as a Bitbucket Pipeline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codiumai-hosted-bitbucket-app" class="md-nav__link">
    <span class="md-ellipsis">
      CodiumAI-hosted Bitbucket app
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bitbucket-server-and-data-center" class="md-nav__link">
    <span class="md-ellipsis">
      Bitbucket Server and Data Center
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-as-cli" class="md-nav__link">
    <span class="md-ellipsis">
      Run as CLI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-as-service" class="md-nav__link">
    <span class="md-ellipsis">
      Run as service
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-privacy" class="md-nav__link">
    <span class="md-ellipsis">
      Data privacy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      Links
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../codiumate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Codiumate
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../alphacodium/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AlphaCodium
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="pr-agent">PR-Agent</h1>
<h2 id="overview">Overview</h2>
<p>CodiumAI GPT-4 powered PR-Agent is an open-source tool to help efficiently review and handle pull requests. </p>
<p>When added to a repository PR-Agent will automatically analyze submitted Pull Request.</p>
<h2 id="try-it-in-a-public-repository">Try it in a public repository</h2>
<p>Mention <code>@CodiumAI-Agent</code> and add the desired command in any PR comment. The agent will generate a response based on your command, for example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>@CodiumAI-Agent /review
</code></pre></div>
The agent will respond with a review of your PR</p>
<p><img alt="Review generation process" src="https://www.codium.ai/images/demo-2.gif" /></p>
<h2 id="available-commands">Available commands</h2>
<p>Use one of the commands in a PR comment to get more insights.</p>
<h3 id="ask">Ask</h3>
<p><code>/ask {your question}</code> - Answers free-text questions about the PR.</p>
<p><a href="https://github.com/Codium-ai/pr-agent/pull/229#issuecomment-1695020538" target="_blank">Example response in Github</a></p>
<p><img alt="" src="https://www.codium.ai/images/ask-2.gif" /></p>
<h3 id="changelog">Changelog</h3>
<p><code>/changelog</code> - Generates update to the CHANGELOG.md file listing relevant PR changes.</p>
<p><a href="https://github.com/Codium-ai/pr-agent/pull/229#issuecomment-1695020538" target="_blank">Example response in Github</a></p>
<h3 id="describe">Describe</h3>
<p><code>/describe</code> - Generates detailed PR description, title, type, summary, code walkthrough and labels.</p>
<p><a href="https://github.com/Codium-ai/pr-agent/pull/530" target="_blank">Example response in Github</a></p>
<h3 id="improve">Improve</h3>
<p><code>/improve</code>: Committable code suggestions for improving the PR.</p>
<p><a href="https://github.com/Codium-ai/pr-agent/pull/472#discussion_r1435819374" target="_blank">Example response in Github</a></p>
<h3 id="review">Review</h3>
<p><code>/review</code> - Generates PR review with test coverage, security issues, score, and insights.</p>
<p><a href="https://github.com/Codium-ai/pr-agent/pull/78#issuecomment-1639739496" target="_blank">Example response in Github</a></p>
<hr />
<h2 id="benefits-of-pr-agent">Benefits of PR-Agent</h2>
<ul>
<li><strong>Quick and affordable</strong> answer retrieval (~30 seconds). Each tool (review, improve, ask, ...) has a single GPT-4 call, no more.</li>
<li><strong>Any PR size</strong> can be effectively used in as a context thanks uur compression strategy.</li>
<li><strong>Each command is modular</strong> and can be controlled with shared configuration file. </li>
<li><strong>Multiple git providers</strong> GitHub, Gitlab, Bitbucket are supported.</li>
<li><strong>Multiple platforms</strong> to use the commands (CLI, GitHub Action, GitHub App, Docker, ...) are supported.</li>
<li><strong>Multiple models</strong> (GPT-4, GPT-3.5, Anthropic, Cohere, Llama2) are supported.</li>
</ul>
<hr />
<h2 id="pr-agent-pro">PR-Agent Pro üíé</h2>
<p><a href="https://www.codium.ai/pricing/" target="_blank">PR-Agent Pro</a> is a hosted version of PR-Agent, provided by CodiumAI. </p>
<p>Benefits of PR-Agent Pro:</p>
<ol>
<li>
<p><strong>Fully managed</strong> - We take care of everything for you - hosting, models, regular updates, and more. Installation is as simple as signing up and adding the PR-Agent app to your GitHub\BitBucket repo.</p>
</li>
<li>
<p><strong>Improved privacy</strong> - No data will be stored or used to train models. PR-Agent Pro will employ zero data retention, and will use an OpenAI account with zero data retention.</p>
</li>
<li>
<p><strong>Improved support</strong> - PR-Agent Pro users will receive priority support, and will be able to request new features and capabilities.</p>
</li>
<li>
<p><strong>Extra features</strong> -In addition to the benefits listed above, PR-Agent Pro will emphasize more customization, and the usage of static code analysis, in addition to LLM logic, to improve results. It has the following additional features:</p>
<ul>
<li><a href="https://github.com/Codium-ai/pr-agent/blob/main/docs/REVIEW.md#soc2-ticket-compliance-" target="_blank">SOC2 compliance check</a></li>
<li><a href="https://github.com/Codium-ai/pr-agent/blob/main/docs/ADD_DOCUMENTATION.md" target="_blank">PR documentation</a></li>
<li><a href="https://github.com/Codium-ai/pr-agent/blob/main/docs/DESCRIBE.md#handle-custom-labels-from-the-repos-labels-page-gem" target="_blank">Custom labels</a></li>
<li><a href="https://github.com/Codium-ai/pr-agent/blob/main/Usage.md#global-configuration-file-" target="_blank">Global configuration</a></li>
<li><a href="https://github.com/Codium-ai/pr-agent/blob/main/docs/Analyze.md" target="_blank">Analyze PR components</a></li>
</ul>
</li>
</ol>
<hr />
<h2 id="how-it-works">How it works</h2>
<p><img alt="PR-Agent Tools" src="https://codium.ai/images/pr_agent/diagram-v0.9.png" /></p>
<p>Check out the <a href="./PR_COMPRESSION.md" target="_blank">PR Compression strategy</a> page for more details on how we convert a code diff to a manageable LLM prompt</p>
<hr />
<h2 id="features-support">Features support</h2>
<p>PR-Agent offers extensive pull request functionalities across various git providers.</p>
<p>üíé marks a feature available only in <a href="https://www.codium.ai/pricing/" target="_blank">PR-Agent Pro</a></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th style="text-align: center;">GitHub</th>
<th style="text-align: center;">Gitlab</th>
<th style="text-align: center;">Bitbucket</th>
</tr>
</thead>
<tbody>
<tr>
<td>TOOLS</td>
<td>Review</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td>Incremental</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/Codium-ai/pr-agent/blob/main/docs/REVIEW.md#soc2-ticket-compliance-" target="_blank">SOC2 Compliance</a> üíé</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td>Ask</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td>Describe</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/Codium-ai/pr-agent/blob/main/docs/DESCRIBE.md#inline-file-summary-" target="_blank">Inline file summary</a> üíé</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td>Improve</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td>‚Æë Extended</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/Codium-ai/pr-agent/blob/main/docs/CUSTOM_SUGGESTIONS.md" target="_blank">Custom Suggestions</a> üíé</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td>Reflect and Review</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td>Update CHANGELOG.md</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td>Find Similar Issue</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/Codium-ai/pr-agent/blob/main/docs/ADD_DOCUMENTATION.md" target="_blank">Add PR Documentation</a> üíé</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/Codium-ai/pr-agent/blob/main/docs/DESCRIBE.md#handle-custom-labels-from-the-repos-labels-page-gem" target="_blank">Generate Custom Labels</a> üíé</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/Codium-ai/pr-agent/blob/main/docs/Analyze.md" target="_blank">Analyze PR Components</a> üíé</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td>USAGE</td>
<td>CLI</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td>App / webhook</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td></td>
<td>Tagging bot</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td></td>
<td>Actions</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td></td>
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td>CORE</td>
<td>PR compression</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td>Repo language prioritization</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td>Adaptive and token-aware file patch fitting</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td>Multiple models support</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td>Incremental PR review</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/Codium-ai/pr-agent/blob/main/docs/Analyze.md" target="_blank">Static code analysis</a> üíé</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/Codium-ai/pr-agent/blob/main/Usage.md#global-configuration-file-" target="_blank">Global configuration</a> üíé</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
<td style="text-align: center;">‚úîÔ∏è</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="custom-installation-process">Custom installation process</h2>
<p>To get started with PR-Agent quickly, you first need to acquire two tokens:</p>
<ol>
<li>
<p>An OpenAI key from <a href="https://platform.openai.com/api-keys">here</a>, with access to GPT-4.</p>
</li>
<li>
<p>A GitHub\GitLab\BitBucket personal access token (classic), with the repo scope. [GitHub from <a href="https://github.com/settings/tokens">here</a>]</p>
</li>
</ol>
<p>There are several ways to use PR-Agent:</p>
<p><strong>Locally</strong>
- <a href="INSTALL.md#use-docker-image-no-installation-required">Using Docker image (no installation required)</a>
- <a href="INSTALL.md#run-from-source">Run from source</a></p>
<p><strong>GitHub specific methods</strong>
- <a href="INSTALL.md#run-as-a-github-action">Run as a GitHub Action</a>
- <a href="INSTALL.md#run-as-a-polling-server">Run as a polling server</a>
- <a href="INSTALL.md#run-as-a-github-app">Run as a GitHub App</a>
- <a href="INSTALL.md#deploy-as-a-lambda-function">Deploy as a Lambda Function</a>
- <a href="INSTALL.md#aws-codecommit-setup">AWS CodeCommit</a></p>
<p><strong>GitLab specific methods</strong>
- <a href="INSTALL.md#run-a-gitlab-webhook-server">Run a GitLab webhook server</a></p>
<p><strong>BitBucket specific methods</strong>
- <a href="INSTALL.md#run-as-a-bitbucket-pipeline">Run as a Bitbucket Pipeline</a>
- <a href="INSTALL.md#run-on-a-hosted-bitbucket-app">Run on a hosted app</a>
- <a href="INSTALL.md#bitbucket-server-and-data-center">Bitbucket server and data center</a></p>
<hr />
<h3 id="use-docker-image">Use Docker image</h3>
<p>A list of the relevant tools can be found in the <a href="./docs/TOOLS_GUIDE.md">tools guide</a>.</p>
<p>To invoke a tool (for example <code>review</code>), you can run directly from the Docker image. Here's how:</p>
<ul>
<li>
<p>For GitHub:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>docker run --rm -it -e OPENAI.KEY=&lt;your key&gt; -e GITHUB.USER_TOKEN=&lt;your token&gt; codiumai/pr-agent:latest --pr_url &lt;pr_url&gt; review
</code></pre></div></p>
</li>
<li>
<p>For GitLab:
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>docker run --rm -it -e OPENAI.KEY=&lt;your key&gt; -e CONFIG.GIT_PROVIDER=gitlab -e GITLAB.PERSONAL_ACCESS_TOKEN=&lt;your token&gt; codiumai/pr-agent:latest --pr_url &lt;pr_url&gt; review
</code></pre></div></p>
</li>
</ul>
<p>Note: If you have a dedicated GitLab instance, you need to specify the custom url as variable:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>docker run --rm -it -e OPENAI.KEY=&lt;your key&gt; -e CONFIG.GIT_PROVIDER=gitlab -e GITLAB.PERSONAL_ACCESS_TOKEN=&lt;your token&gt; -e GITLAB.URL=&lt;your gitlab instance url&gt; codiumai/pr-agent:latest --pr_url &lt;pr_url&gt; review
</code></pre></div></p>
<ul>
<li>For BitBucket:
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>docker run --rm -it -e CONFIG.GIT_PROVIDER=bitbucket -e OPENAI.KEY=$OPENAI_API_KEY -e BITBUCKET.BEARER_TOKEN=$BITBUCKET_BEARER_TOKEN codiumai/pr-agent:latest --pr_url=&lt;pr_url&gt; review
</code></pre></div></li>
</ul>
<p>For other git providers, update CONFIG.GIT_PROVIDER accordingly, and check the <code>pr_agent/settings/.secrets_template.toml</code> file for the environment variables expected names and values.</p>
<hr />
<p>If you want to ensure you're running a specific version of the Docker image, consider using the image's digest:
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-it<span class="w"> </span>-e<span class="w"> </span>OPENAI.KEY<span class="o">=</span>&lt;your<span class="w"> </span>key&gt;<span class="w"> </span>-e<span class="w"> </span>GITHUB.USER_TOKEN<span class="o">=</span>&lt;your<span class="w"> </span>token&gt;<span class="w"> </span>codiumai/pr-agent@sha256:71b5ee15df59c745d352d84752d01561ba64b6d51327f97d46152f0c58a5f678<span class="w"> </span>--pr_url<span class="w"> </span>&lt;pr_url&gt;<span class="w"> </span>review
</code></pre></div></p>
<p>Or you can run a <a href="./RELEASE_NOTES.md">specific released versions</a> of pr-agent, for example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>codiumai/pr-agent@v0.9
</code></pre></div></p>
<hr />
<h3 id="run-from-source">Run from source</h3>
<ol>
<li>Clone this repository:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>git clone https://github.com/Codium-ai/pr-agent.git
</code></pre></div>
<ol>
<li>Navigate to the <code>/pr-agent</code> folder and install the requirements in your favorite virtual environment:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>pip install -e .
</code></pre></div>
<p><em>Note: If you get an error related to Rust in the dependency installation then make sure Rust is installed and in your <code>PATH</code>, instructions: https://rustup.rs</em></p>
<ol>
<li>Copy the secrets template file and fill in your OpenAI key and your GitHub user token:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>cp pr_agent/settings/.secrets_template.toml pr_agent/settings/.secrets.toml
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>chmod 600 pr_agent/settings/.secrets.toml
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a># Edit .secrets.toml file
</code></pre></div>
<ol>
<li>Run the cli.py script:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>python3 -m pr_agent.cli --pr_url &lt;pr_url&gt; review
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>python3 -m pr_agent.cli --pr_url &lt;pr_url&gt; ask &lt;your question&gt;
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>python3 -m pr_agent.cli --pr_url &lt;pr_url&gt; describe
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>python3 -m pr_agent.cli --pr_url &lt;pr_url&gt; improve
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>python3 -m pr_agent.cli --pr_url &lt;pr_url&gt; add_docs
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>python3 -m pr_agent.cli --pr_url &lt;pr_url&gt; generate_labels
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>python3 -m pr_agent.cli --issue_url &lt;issue_url&gt; similar_issue
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>...
</code></pre></div>
<p>[Optional]¬†Add the pr_agent folder to your PYTHONPATH
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>export PYTHONPATH=$PYTHONPATH:&lt;PATH to pr_agent folder&gt;
</code></pre></div></p>
<hr />
<h3 id="run-as-a-github-action">Run as a GitHub Action</h3>
<p>You can use our pre-built Github Action Docker image to run PR-Agent as a Github Action.</p>
<ol>
<li>Add the following file to your repository under <code>.github/workflows/pr_agent.yml</code>:</li>
</ol>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nt">on</span><span class="p">:</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">  </span><span class="nt">issue_comment</span><span class="p">:</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="nt">jobs</span><span class="p">:</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">  </span><span class="nt">pr_agent_job</span><span class="p">:</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">    </span><span class="nt">permissions</span><span class="p">:</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">      </span><span class="nt">issues</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">      </span><span class="nt">pull-requests</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">      </span><span class="nt">contents</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run pr agent on every pull request, respond to user comments</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PR Agent action step</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="w">        </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pragent</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Codium-ai/pr-agent@main</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="w">          </span><span class="nt">OPENAI_KEY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.OPENAI_KEY }}</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="w">          </span><span class="nt">GITHUB_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.GITHUB_TOKEN }}</span>
</code></pre></div>
** if you want to pin your action to a specific release (v0.7 for example) for stability reasons, use:
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nt">on</span><span class="p">:</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">  </span><span class="nt">issue_comment</span><span class="p">:</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="nt">jobs</span><span class="p">:</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">  </span><span class="nt">pr_agent_job</span><span class="p">:</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">    </span><span class="nt">permissions</span><span class="p">:</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="w">      </span><span class="nt">issues</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="w">      </span><span class="nt">pull-requests</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="w">      </span><span class="nt">contents</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run pr agent on every pull request, respond to user comments</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PR Agent action step</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="w">        </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pragent</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Codium-ai/pr-agent@v0.7</span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="w">          </span><span class="nt">OPENAI_KEY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.OPENAI_KEY }}</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="w">          </span><span class="nt">GITHUB_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.GITHUB_TOKEN }}</span>
</code></pre></div>
2. Add the following secret to your repository under <code>Settings &gt; Secrets and variables &gt; Actions &gt; New repository secret &gt; Add secret</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>Name = OPENAI_KEY
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>Secret = &lt;your key&gt;
</code></pre></div>
<p>The GITHUB_TOKEN secret is automatically created by GitHub.</p>
<ol>
<li>
<p>Merge this change to your main branch.
When you open your next PR, you should see a comment from <code>github-actions</code> bot with a review of your PR, and instructions on how to use the rest of the tools.</p>
</li>
<li>
<p>You may configure PR-Agent by adding environment variables under the env section corresponding to any configurable property in the <a href="pr_agent/settings/configuration.toml">configuration</a> file. Some examples:
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="w">      </span><span class="nt">env</span><span class="p">:</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">        </span><span class="c1"># ... previous environment values</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">        </span><span class="nt">OPENAI.ORG</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;Your</span><span class="nv"> </span><span class="s">organization</span><span class="nv"> </span><span class="s">name</span><span class="nv"> </span><span class="s">under</span><span class="nv"> </span><span class="s">your</span><span class="nv"> </span><span class="s">OpenAI</span><span class="nv"> </span><span class="s">account&gt;&quot;</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">        </span><span class="nt">PR_REVIEWER.REQUIRE_TESTS_REVIEW</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="c1"># Disable tests review</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">        </span><span class="nt">PR_CODE_SUGGESTIONS.NUM_CODE_SUGGESTIONS</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span><span class="w"> </span><span class="c1"># Increase number of code suggestions</span>
</code></pre></div></p>
</li>
</ol>
<hr />
<h3 id="run-as-a-polling-server">Run as a polling server</h3>
<p>Request reviews by tagging your GitHub user on a PR</p>
<p>Follow <a href="#run-as-a-github-action">steps 1-3</a> of the GitHub Action setup.</p>
<p>Run the following command to start the server:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>python pr_agent/servers/github_polling.py
</code></pre></div>
<hr />
<h3 id="run-as-a-github-app">Run as a GitHub App</h3>
<p>Allowing you to automate the review process on your private or public repositories.</p>
<ol>
<li>
<p>Create a GitHub App from the <a href="https://docs.github.com/en/developers/apps/creating-a-github-app">Github Developer Portal</a>.</p>
</li>
<li>
<p>Set the following permissions:</p>
<ul>
<li>Pull requests: Read &amp; write</li>
<li>Issue comment: Read &amp; write</li>
<li>Metadata: Read-only</li>
<li>Contents: Read-only</li>
</ul>
</li>
<li>
<p>Set the following events:</p>
<ul>
<li>Issue comment</li>
<li>Pull request</li>
<li>Push (if you need to enable triggering on PR update)</li>
</ul>
</li>
<li>
<p>Generate a random secret for your app, and save it for later. For example, you can use:</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>WEBHOOK_SECRET=$(python -c &quot;import secrets; print(secrets.token_hex(10))&quot;)
</code></pre></div>
<ol>
<li>
<p>Acquire the following pieces of information from your app's settings page:</p>
</li>
<li>
<p>App private key (click "Generate a private key" and save the file)</p>
</li>
<li>
<p>App ID</p>
</li>
<li>
<p>Clone this repository:</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>git clone https://github.com/Codium-ai/pr-agent.git
</code></pre></div>
<ol>
<li>Copy the secrets template file and fill in the following:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>cp pr_agent/settings/.secrets_template.toml pr_agent/settings/.secrets.toml
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a># Edit .secrets.toml file
</code></pre></div></li>
<li>Your OpenAI key.</li>
<li>Copy your app's private key to the private_key field.</li>
<li>Copy your app's ID to the app_id field.</li>
<li>Copy your app's webhook secret to the webhook_secret field.</li>
<li>Set deployment_type to 'app' in <a href="./pr_agent/settings/configuration.toml">configuration.toml</a></li>
</ol>
<blockquote>
<p>The .secrets.toml file is not copied to the Docker image by default, and is only used for local development.
If you want to use the .secrets.toml file in your Docker image, you can add remove it from the .dockerignore file.
In most production environments, you would inject the secrets file as environment variables or as mounted volumes.
For example, in order to inject a secrets file as a volume in a Kubernetes environment you can update your pod spec to include the following,
assuming you have a secret named <code>pr-agent-settings</code> with a key named <code>.secrets.toml</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>       volumes:
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>        - name: settings-volume
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>          secret:
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>            secretName: pr-agent-settings
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>// ...
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>       containers:
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>// ...
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>          volumeMounts:
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>            - mountPath: /app/pr_agent/settings_prod
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>              name: settings-volume
</code></pre></div></p>
<p>Another option is to set the secrets as environment variables in your deployment environment, for example <code>OPENAI.KEY</code> and <code>GITHUB.USER_TOKEN</code>.</p>
</blockquote>
<ol>
<li>Build a Docker image for the app and optionally push it to a Docker repository. We'll use Dockerhub as an example:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>docker build . -t codiumai/pr-agent:github_app --target github_app -f docker/Dockerfile
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>docker push codiumai/pr-agent:github_app  # Push to your Docker repository
</code></pre></div>
<ol>
<li>
<p>Host the app using a server, serverless function, or container environment. Alternatively, for development and
   debugging, you may use tools like smee.io to forward webhooks to your local machine.
    You can check <a href="#deploy-as-a-lambda-function">Deploy as a Lambda Function</a></p>
</li>
<li>
<p>Go back to your app's settings, and set the following:</p>
</li>
<li>
<p>Webhook URL: The URL of your app's server or the URL of the smee.io channel.</p>
</li>
<li>
<p>Webhook secret: The secret you generated earlier.</p>
</li>
<li>
<p>Install the app by navigating to the "Install App" tab and selecting your desired repositories.</p>
</li>
</ol>
<blockquote>
<p><strong>Note:</strong> When running PR-Agent from GitHub App, the default configuration file (configuration.toml) will be loaded.
However, you can override the default tool parameters by uploading a local configuration file <code>.pr_agent.toml</code>
For more information please check out the <a href="./Usage.md#working-with-github-app">USAGE GUIDE</a></p>
</blockquote>
<hr />
<h3 id="deploy-as-lambda-function">Deploy as Lambda Function</h3>
<ol>
<li>Follow steps 1-5 of <a href="#run-as-a-github-app">Method 5</a>.</li>
<li>Build a docker image that can be used as a lambda function
    <code>shell
    docker buildx build --platform=linux/amd64 . -t codiumai/pr-agent:serverless -f docker/Dockerfile.lambda</code></li>
<li>Push image to ECR
    <div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>docker<span class="w"> </span>tag<span class="w"> </span>codiumai/pr-agent:serverless<span class="w"> </span>&lt;AWS_ACCOUNT&gt;.dkr.ecr.&lt;AWS_REGION&gt;.amazonaws.com/codiumai/pr-agent:serverless
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>docker<span class="w"> </span>push<span class="w"> </span>&lt;AWS_ACCOUNT&gt;.dkr.ecr.&lt;AWS_REGION&gt;.amazonaws.com/codiumai/pr-agent:serverless
</code></pre></div></li>
<li>Create a lambda function that uses the uploaded image. Set the lambda timeout to be at least 3m.</li>
<li>Configure the lambda function to have a Function URL.</li>
<li>In the environment variables of the Lambda function, specify <code>AZURE_DEVOPS_CACHE_DIR</code> to a writable location such as /tmp. (see <a href="https://github.com/Codium-ai/pr-agent/pull/450#issuecomment-1840242269">link</a>)</li>
<li>Go back to steps 8-9 of <a href="#run-as-a-github-app">Method 5</a> with the function url as your Webhook URL.
    The Webhook URL would look like <code>https://&lt;LAMBDA_FUNCTION_URL&gt;/api/v1/github_webhooks</code></li>
</ol>
<hr />
<h3 id="aws-codecommit-setup">AWS CodeCommit Setup</h3>
<p>Not all features have been added to CodeCommit yet.  As of right now, CodeCommit has been implemented to run the pr-agent CLI on the command line, using AWS credentials stored in environment variables.  (More features will be added in the future.)  The following is a set of instructions to have pr-agent do a review of your CodeCommit pull request from the command line:</p>
<ol>
<li>Create an IAM user that you will use to read CodeCommit pull requests and post comments<ul>
<li>Note: That user should have CLI access only, not Console access</li>
</ul>
</li>
<li>Add IAM permissions to that user, to allow access to CodeCommit (see IAM Role example below)</li>
<li>Generate an Access Key for your IAM user</li>
<li>Set the Access Key and Secret using environment variables (see Access Key example below)</li>
<li>Set the <code>git_provider</code> value to <code>codecommit</code> in the <code>pr_agent/settings/configuration.toml</code> settings file</li>
<li>Set the <code>PYTHONPATH</code> to include your <code>pr-agent</code> project directory<ul>
<li>Option A: Add <code>PYTHONPATH="/PATH/TO/PROJECTS/pr-agent</code> to your <code>.env</code> file</li>
<li>Option B: Set <code>PYTHONPATH</code> and run the CLI in one command, for example:<ul>
<li><code>PYTHONPATH="/PATH/TO/PROJECTS/pr-agent python pr_agent/cli.py [--ARGS]</code></li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="iam-role-example">IAM Role Example</h4>
<p>Example IAM permissions to that user to allow access to CodeCommit:</p>
<ul>
<li>Note: The following is a working example of IAM permissions that has read access to the repositories and write access to allow posting comments</li>
<li>Note: If you only want pr-agent to review your pull requests, you can tighten the IAM permissions further, however this IAM example will work, and allow the pr-agent to post comments to the PR</li>
<li>Note: You may want to replace the <code>"Resource": "*"</code> with your list of repos, to limit access to only those repos</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>{
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>    &quot;Version&quot;: &quot;2012-10-17&quot;,
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>    &quot;Statement&quot;: [
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>        {
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>            &quot;Effect&quot;: &quot;Allow&quot;,
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>            &quot;Action&quot;: [
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>                &quot;codecommit:BatchDescribe*&quot;,
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>                &quot;codecommit:BatchGet*&quot;,
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>                &quot;codecommit:Describe*&quot;,
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>                &quot;codecommit:EvaluatePullRequestApprovalRules&quot;,
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>                &quot;codecommit:Get*&quot;,
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>                &quot;codecommit:List*&quot;,
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>                &quot;codecommit:PostComment*&quot;,
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a>                &quot;codecommit:PutCommentReaction&quot;,
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>                &quot;codecommit:UpdatePullRequestDescription&quot;,
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a>                &quot;codecommit:UpdatePullRequestTitle&quot;
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>            ],
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>            &quot;Resource&quot;: &quot;*&quot;
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a>        }
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a>    ]
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a>}
</code></pre></div>
<h4 id="access-key-and-secret">Access Key and Secret</h4>
<p>Example setting the Access Key and Secret using environment variables</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">AWS_ACCESS_KEY_ID</span><span class="o">=</span><span class="s2">&quot;XXXXXXXXXXXXXXXX&quot;</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">AWS_SECRET_ACCESS_KEY</span><span class="o">=</span><span class="s2">&quot;XXXXXXXXXXXXXXXX&quot;</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">AWS_DEFAULT_REGION</span><span class="o">=</span><span class="s2">&quot;us-east-1&quot;</span>
</code></pre></div>
<h4 id="cli-example">CLI Example</h4>
<p>After you set up AWS CodeCommit using the instructions above, here is an example CLI run that tells pr-agent to <strong>review</strong> a given pull request.
(Replace your specific PYTHONPATH and PR URL in the example)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="nv">PYTHONPATH</span><span class="o">=</span><span class="s2">&quot;/PATH/TO/PROJECTS/pr-agent&quot;</span><span class="w"> </span>python<span class="w"> </span>pr_agent/cli.py<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">  </span>--pr_url<span class="w"> </span>https://us-east-1.console.aws.amazon.com/codesuite/codecommit/repositories/MY_REPO_NAME/pull-requests/321<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">  </span>review
</code></pre></div>
<hr />
<h3 id="run-a-gitlab-webhook">Run a GitLab webhook</h3>
<ol>
<li>From the GitLab workspace or group, create an access token. Enable the "api" scope only.</li>
<li>Generate a random secret for your app, and save it for later. For example, you can use:</li>
</ol>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>WEBHOOK_SECRET=$(python -c &quot;import secrets; print(secrets.token_hex(10))&quot;)
</code></pre></div>
3. Follow the instructions to build the Docker image, setup a secrets file and deploy on your own server from <a href="#run-as-a-github-app">Method 5</a> steps 4-7.
4. In the secrets file, fill in the following:
    - Your OpenAI key.
    - In the [gitlab] section, fill in personal_access_token and shared_secret. The access token can be a personal access token, or a group or project access token.
    - Set deployment_type to 'gitlab' in <a href="./pr_agent/settings/configuration.toml">configuration.toml</a>
5. Create a webhook in GitLab. Set the URL to the URL of your app's server. Set the secret token to the generated secret from step 2.
In the "Trigger" section, check the ‚Äòcomments‚Äô and ‚Äòmerge request events‚Äô boxes.
6. Test your installation by opening a merge request or commenting or a merge request using one of CodiumAI's commands.</p>
<h3 id="run-as-a-bitbucket-pipeline">Run as a Bitbucket Pipeline</h3>
<p>You can use the Bitbucket Pipeline system to run PR-Agent on every pull request open or update.</p>
<ol>
<li>Add the following file in your repository bitbucket_pipelines.yml</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nt">pipelines</span><span class="p">:</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">    </span><span class="nt">pull-requests</span><span class="p">:</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">      </span><span class="s">&#39;**&#39;</span><span class="p p-Indicator">:</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">step</span><span class="p">:</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PR Agent Review</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">            </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python:3.10</span>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">            </span><span class="nt">services</span><span class="p">:</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">            </span><span class="nt">script</span><span class="p">:</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker run -e CONFIG.GIT_PROVIDER=bitbucket -e OPENAI.KEY=$OPENAI_API_KEY -e BITBUCKET.BEARER_TOKEN=$BITBUCKET_BEARER_TOKEN codiumai/pr-agent:latest --pr_url=https://bitbucket.org/$BITBUCKET_WORKSPACE/$BITBUCKET_REPO_SLUG/pull-requests/$BITBUCKET_PR_ID review</span>
</code></pre></div>
<ol>
<li>Add the following secure variables to your repository under Repository settings &gt; Pipelines &gt; Repository variables.
OPENAI_API_KEY: <code>&lt;your key&gt;</code>
BITBUCKET_BEARER_TOKEN: <code>&lt;your token&gt;</code></li>
</ol>
<p>You can get a Bitbucket token for your repository by following Repository Settings -&gt; Security -&gt; Access Tokens.</p>
<p>Note that comments on a PR are not supported in Bitbucket Pipeline.</p>
<h3 id="codiumai-hosted-bitbucket-app">CodiumAI-hosted Bitbucket app</h3>
<p>Please contact <a href="mailto:support@codium.ai">support@codium.ai</a> or visit <a href="https://www.codium.ai/pricing/">CodiumAI pricing page</a> if you're interested in a hosted BitBucket app solution that provides full functionality including PR reviews and comment handling. It's based on the <a href="https://github.com/Codium-ai/pr-agent/blob/main/pr_agent/git_providers/bitbucket_provider.py">bitbucket_app.py</a> implementation.</p>
<h3 id="bitbucket-server-and-data-center">Bitbucket Server and Data Center</h3>
<p>Login into your on-prem instance of Bitbucket with your service account username and password.
Navigate to <code>Manage account</code>, <code>HTTP Access tokens</code>, <code>Create Token</code>.
Generate the token and add it to .secret.toml under <code>bitbucket_server</code> section</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="k">[bitbucket_server]</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="n">bearer_token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;your key&gt;&quot;</span>
</code></pre></div>
<h3 id="run-as-cli">Run as CLI</h3>
<p>Modify <code>configuration.toml</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="n">git_provider</span><span class="o">=</span><span class="s2">&quot;bitbucket_server&quot;</span>
</code></pre></div>
<p>and pass the Pull request URL:
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>python<span class="w"> </span>cli.py<span class="w"> </span>--pr_url<span class="w"> </span>https://git.onpreminstanceofbitbucket.com/projects/PROJECT/repos/REPO/pull-requests/1<span class="w"> </span>review
</code></pre></div></p>
<h3 id="run-as-service">Run as service</h3>
<p>To run pr-agent as webhook, build the docker image:
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>docker build . -t codiumai/pr-agent:bitbucket_server_webhook --target bitbucket_server_webhook -f docker/Dockerfile
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>docker push codiumai/pr-agent:bitbucket_server_webhook  # Push to your Docker repository
</code></pre></div></p>
<p>Navigate to <code>Projects</code> or <code>Repositories</code>, <code>Settings</code>, <code>Webhooks</code>, <code>Create Webhook</code>.
Fill the name and URL, Authentication None select the Pull Request Opened checkbox to receive that event as webhook.</p>
<p>The URL should end with <code>/webhook</code>, for example: https://domain.com/webhook</p>
<h2 id="data-privacy">Data privacy</h2>
<p>If you host PR-Agent with your OpenAI API key, it is between you and OpenAI. You can read their API data privacy policy here:
https://openai.com/enterprise-privacy</p>
<p>When using PR-Agent Pro üíé, hosted by CodiumAI, we will not store any of your data, nor will we use it for training.
You will also benefit from an OpenAI account with zero data retention.</p>
<hr />
<h2 id="links">Links</h2>
<ul>
<li><a href="https://discord.gg/kG35uSHDBc{:target=&quot;_blank&quot;}">Discord community</a></li>
<li><a href="https://codium.ai{:target=&quot;_blank&quot;}">CodiumAI website</a></li>
<li><a href="https://www.codium.ai/blog/{:target=&quot;_blank&quot;}">Blog</a></li>
<li><a href="https://www.codium.ai/blog/technical-faq-and-troubleshooting/{:target=&quot;_blank&quot;}">Troubleshooting</a></li>
</ul>
<p><a href="https://discord.gg/kG35uSHDBc" target="_blank"><img alt="Join our Discord community" src="https://raw.githubusercontent.com/Codium-ai/codiumai-vscode-release/main/media/docs/Joincommunity.png" /></a></p>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024 <a href="https://www.codium.ai/"  target="_blank" rel="noopener">CodiumAI</a>
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Codium-ai" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://discord.com/invite/SgSxuQ65GF" target="_blank" rel="noopener" title="discord.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/@Codium-AI" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/codiumai" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/CodiumAI" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.instagram.com/codiumai/" target="_blank" rel="noopener" title="www.instagram.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy", "toc.integrate"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8d2eff1.min.js"></script>
      
    
  </body>
</html>